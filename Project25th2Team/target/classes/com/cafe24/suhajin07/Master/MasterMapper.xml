<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.cafe24.suhajin07.Master.MasterMapper">
	<resultMap type="com.cafe24.suhajin07.Master.Master" id="resultMaster">
		<result property="memberCode" column="memberCode" />
		<result property="memberId" column="memberId" />
		<result property="memberPw" column="memberPw" />
		<result property="memberName" column="memberName" />
		<result property="memberPhone" column="memberPhone" />
		<result property="memberEmail" column="memberEmail" />
		<result property="memberPostNum" column="memberPostNum" />
		<result property="memberAddress" column="memberAddress" />
		<result property="memberDetailAddress" column="memberDetailAddress" />
		<result property="memberGrade" column="memberGrade" />
		<result property="managerCode" column="managerCode" />
		<result property="managerName" column="managerName" />
		<result property="memberDate" column="memberDate" />
		<result property="gradeName" column="gradeName" />
		<result property="managerDepartment" column="managerDepartment" />
		<result property="managerGradeCode" column="managerGradeCode" />
		<result property="managerBasePay" column="managerBasePay" />
		<result property="bankCode" column="bankCode" />
		<result property="bankName" column="bankName" />
		<result property="bankNum" column="bankNum" />

	</resultMap>

	<select id="memberAllList" parameterType="com.cafe24.suhajin07.Master.Master"
		resultMap="resultMaster">
		SELECT
		memberCode,memberId,memberName,memberPhone,memberEmail,memberPostNum,
		memberAddress,memberDetailAddress,memberDate
		from member where
		memberGrade =
		'member' order by memberCode
	</select>
	<select id="managerAllList" parameterType="com.cafe24.suhajin07.Master.Master"
		resultMap="resultMaster">
		SELECT
		member.memberCode,managerCode,gradeName,memberName,memberPhone,memberEmail,memberPostNum,
		memberAddress,memberDetailAddress,managerDepartment,memberDate
		from
		member join
		manager join
		managerGrade
		on member.memberId=manager.memberId
		and
		manager.managerGradeCode=managerGrade.managerGradeCode
		where
		memberGrade =
		'manager' order by manager.managerGradeCode
	</select>
	<select id="managerGradeList_1" parameterType="com.cafe24.suhajin07.Master.Master"
		resultMap="resultMaster">
		SELECT
		manager.memberId,manager.managerCode,
		managerGrade.gradeName,member.memberName,member.memberPhone,
		member.memberEmail,manager.managerDepartment,salary.bankNum,bank.bankName
		from
		member join
		manager join managerGrade join salary join bank
		on
		member.memberCode=manager.memberCode and
		manager.managerGradeCode=managerGrade.managerGradeCode
		and
		manager.managerCode=salary.managerCode and
		salary.bankCode =
		bank.bankCode
		where gradeName
		=
		'총괄매니저' order by memberId
	</select>
	<select id="managerGradeList_2" parameterType="com.cafe24.suhajin07.Master.Master"
		resultMap="resultMaster">
		SELECT
		manager.memberId,manager.managerCode,
		managerGrade.gradeName,member.memberName,member.memberPhone,
		member.memberEmail,manager.managerDepartment,salary.bankNum,bank.bankName
		from
		member join
		manager join managerGrade join salary join bank
		on
		member.memberCode=manager.memberCode and
		manager.managerGradeCode=managerGrade.managerGradeCode
		and
		manager.managerCode=salary.managerCode and
		salary.bankCode =
		bank.bankCode
		where gradeName
		=
		'담당 실장' order by memberId
	</select>
	<select id="managerGradeList_3" parameterType="com.cafe24.suhajin07.Master.Master"
		resultMap="resultMaster">
		SELECT
		manager.memberId,manager.managerCode,
		managerGrade.gradeName,member.memberName,member.memberPhone,
		member.memberEmail,manager.managerDepartment,salary.bankNum,bank.bankName
		from
		member join
		manager join managerGrade join salary join bank
		on
		member.memberCode=manager.memberCode and
		manager.managerGradeCode=managerGrade.managerGradeCode
		and
		manager.managerCode=salary.managerCode and
		salary.bankCode =
		bank.bankCode
		where gradeName
		=
		'담당 부실장' order by memberId
	</select>
	<select id="managerGradeList_4" parameterType="com.cafe24.suhajin07.Master.Master"
		resultMap="resultMaster">
		SELECT
		manager.memberId,manager.managerCode,
		managerGrade.gradeName,member.memberName,member.memberPhone,
		member.memberEmail,manager.managerDepartment,salary.bankNum,bank.bankName
		from
		member join
		manager join managerGrade join salary join bank
		on
		member.memberCode=manager.memberCode and
		manager.managerGradeCode=managerGrade.managerGradeCode
		and
		manager.managerCode=salary.managerCode and
		salary.bankCode =
		bank.bankCode
		where gradeName
		=
		'담당 매니저' order by memberId
	</select>
	<select id="managerGradeList_5" parameterType="com.cafe24.suhajin07.Master.Master"
		resultMap="resultMaster">
		SELECT
		manager.memberId,manager.managerCode,
		managerGrade.gradeName,member.memberName,member.memberPhone,
		member.memberEmail,manager.managerDepartment,salary.bankNum,bank.bankName
		from
		member join
		manager join managerGrade join salary join bank
		on
		member.memberCode=manager.memberCode and
		manager.managerGradeCode=managerGrade.managerGradeCode
		and
		manager.managerCode=salary.managerCode and
		salary.bankCode =
		bank.bankCode
		where gradeName
		=
		'수습 매니저' order by memberId
	</select>
	<insert id="insertManager" parameterType="com.cafe24.suhajin07.Master.Master">
		INSERT INTO
		member(memberCode ,memberId ,memberPw ,memberName
		,memberPhone,memberEmail ,memberPostNum, memberDetailAddress,
		memberAddress ,memberGrade ,memberDate)
		VALUES
		(#{memberCode},
		#{memberId}, #{memberPw}, #{memberName}, #{memberPhone},
		#{memberEmail}, #{memberPostNum}, #{memberDetailAddress},
		#{memberAddress}, #{memberGrade} ,now())
	</insert>
	<insert id="insertManagerGrade" parameterType="com.cafe24.suhajin07.Master.Master">
		<selectKey resultType="hashmap" keyProperty="memberCode,memberName"
			order="BEFORE">
			select memberCode,memberName from member order by memberCode
			DESC limit 1
		</selectKey>
		INSERT INTO
		manager(managerCode,memberCode,memberId,managerGradeCode,managerName,managerDepartment)
		VALUES
		(#{managerCode}, #{memberCode}, #{memberId},
		#{managerGradeCode}, #{memberName},
		#{managerDepartment})
	</insert>

	<select id="managerselectOne" parameterType="com.cafe24.suhajin07.Master.Master"
		resultMap="resultMaster">
		SELECT * from manager
		where managerCode = #{managerCode}
	</select>

	<update id="managerGradeupdate" parameterType="com.cafe24.suhajin07.Master.Master">
		UPDATE manager set
		memberCode = #{memberCode},
		memberId = #{memberId},
		managerGradeCode = #{managerGradeCode},
		managerName = #{managerName},
		managerDepartment = #{managerDepartment}
		where
		managerCode = #{managerCode}
	</update>
	
	<delete id="ManagerDelete">
		DELETE from manager where managerCode = #{managerCode}
	</delete>
	

</mapper>